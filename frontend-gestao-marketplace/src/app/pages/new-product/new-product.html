<div class="w-full py-7 px-14 pt-20 bg-gray-50 min-h-screen">
  <div class="max-w-4xl mx-auto">
    
    <div class="mb-8">
      <h1 class="text-3xl font-semibold text-gray-900">Adicionar Produto</h1>
      <p class="text-base text-gray-600 mt-1">Cadastre um novo produto no estoque do Fluxa ERP.</p>
    </div>

    <form [formGroup]="productForm" (ngSubmit)="createProduct()">
      <div class="bg-white rounded-xl shadow-lg p-8 border border-gray-100 flex flex-col gap-8">
        
        <div class="flex items-center gap-3 border-b border-gray-100 pb-4">
          <img src="assets/box-icon.svg" class="w-6 h-6 text-blue-600" alt="Ícone de Produto" />
          <h3 class="text-xl font-semibold text-gray-800">Dados do Produto</h3>
        </div>
        
        @if (apiErrorMessage) {
            <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
                <span class="block sm:inline">{{ apiErrorMessage }}</span>
            </div>
        }

        <div class="flex flex-col gap-6">
          
          <div>
            <label for="title" class="block text-sm font-medium text-gray-700 mb-1">Nome do Produto</label>
            <input
              id="title"
              type="text"
              formControlName="title"
              class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150"
              placeholder="Ex: Notebook Dell Inspiron"
            />
          </div>
          
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
            <div>
              <label for="supplier" class="block text-sm font-medium text-gray-700 mb-1">Fornecedor</label>
              <input
                id="supplier"
                type="text"
                formControlName="supplier"
                class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150"
                placeholder="Ex: Tech Distribuidor"
              />
            </div>
            
            <div>
              <label for="category" class="block text-sm font-medium text-gray-700 mb-1">Categoria</label>
              <select 
                id="category" 
                formControlName="category"
                class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 bg-white appearance-none"
              >
                <option value="" disabled>Selecione a Categoria</option> 
                <option value="eletronicos">Eletrônicos</option>
                <option value="movel">Móvel</option>
                <option value="vestuario">Vestuário</option>
              </select>
              </div>
          </div>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
            <div>
              <label for="purchase_price" class="block text-sm font-medium text-gray-700 mb-1">Valor de Compra (R$)</label>
              <input
                id="purchase_price"
                type="number"
                step="0.01"
                formControlName="purchase_price"
                class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150"
                placeholder="0.00"
              />
            </div>
            <div>
              <label for="sale_price" class="block text-sm font-medium text-gray-700 mb-1">Valor de Venda (R$)</label>
              <input
                id="sale_price"
                type="number"
                step="0.01"
                formControlName="sale_price"
                class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150"
                placeholder="0.00"
              />
            </div>
          </div>
          
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
            <div>
              <label for="quantity" class="block text-sm font-medium text-gray-700 mb-1">Quantidade em Estoque</label>
              <input
                id="quantity"
                type="number"
                formControlName="quantity"
                class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150"
                placeholder="0"
              />
            </div>
            <div>
              <label for="date" class="block text-sm font-medium text-gray-700 mb-1">Data de Cadastro</label>
              <input
                id="date"
                type="date"
                formControlName="date"
                class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150"
              />
            </div>
          </div>

          <div>
            <label for="description" class="block text-sm font-medium text-gray-700 mb-1">Descrição</label>
            <textarea
              id="description"
              formControlName="description"
              rows="3"
              class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 resize-none"
              placeholder="Escreva detalhes sobre o produto, tamanho, características"
            ></textarea>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Imagem do Produto (Base64)</label>
            <input 
              type="file"
              id="image-upload-input"
              (change)="onFileSelected($event)"
              class="w-full border border-gray-300 rounded-lg p-3 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"
              accept=".png, .jpg, .jpeg"
            />
            @if (productForm.get('imageBase64')?.value) {
                <p class="text-xs text-green-600 mt-1">Imagem selecionada com sucesso.</p>
            }
            </div>

        </div>

        <div class="w-full flex gap-4 pt-4 border-t border-gray-100">
          <button 
            type="button" 
            routerLink="/products"
            class="flex flex-1 justify-center p-3 rounded-lg border border-gray-300 text-gray-700 text-sm font-semibold hover:bg-gray-50 transition duration-200"
          >
            Cancelar
          </button>
          <button 
            type="submit" 
            [disabled]="productForm.invalid"
            class="flex flex-1 justify-center p-3 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white text-sm font-semibold transition duration-200 disabled:opacity-50"
          >
            Adicionar Produto
          </button>
        </div>
      </div>
    </form>
  </div>
</div>